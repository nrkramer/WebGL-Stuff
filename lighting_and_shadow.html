<!--
This project was written by:
Nolan - Coding the rotation and camera controls (made the Pyramid)
Eric - Helped with coding and made the phone case model
Riley - Made the colored cube
Will - Made the hexagonal prism
-->

<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
		<title>Lighting and Shadow</title>

		<script id="vertex-shader" type="x-shader/x-vertex">
			attribute vec3 aPosition;
			attribute vec4 aVertexColor;
			attribute vec2 aTextureCoord;
			attribute vec3 aNormal;

			// Matrices to create 3D perspective. Make the GPU do the multiplications
			uniform mat4 model;
			uniform mat4 view;
			uniform mat4 projection;
			uniform mat4 normalMatrix;

			varying mediump vec4 vColor;
			varying highp vec2 vTex;
			varying mediump vec3 vNormalInterp; // Interpolated normals
			varying mediump vec3 vVertexPos; // Vertex position

			void main() {
				mat4 MV = view * model;
				vColor = aVertexColor; // send color to fragment shader
				vTex = aTextureCoord; // send texture color to fragment shader
				vec4 vertPos4 = MV * vec4(aPosition, 1.0); // calculate interpolated vertex normals
				vVertexPos = vec3(vertPos4) / vertPos4.w;
				vNormalInterp = vec3(normalMatrix * vec4(aNormal, 0.0)); // send interpolated vertex normals to fragment shader
				gl_Position = projection * MV * vec4(aPosition, 1.0);
			}
		</script>

		<script id="fragment-shader" type="x-shader/x-fragment">
			precision mediump float;

			varying mediump vec4 vColor;
			varying highp vec2 vTex;
			varying mediump vec3 vNormalInterp;
			varying mediump vec3 vVertexPos;

			uniform sampler2D uSampler;

			uniform vec3 lightPos;
			const vec3 ambientColor = vec3(0.1, 0.1, 0.1);
			const vec3 diffuseColor = vec3(0.5, 0.5, 0.5);
			const vec3 specColor = vec3(1.0, 1.0, 1.0);

			void main() {
				// blinn-phong
				vec3 normal = normalize(vNormalInterp);
			  vec3 lightDir = normalize(lightPos - vVertexPos);

			  float lambertian = max(dot(lightDir, normal), 0.0);
			  float specular = 0.0;

			  if(lambertian > 0.0) {
			    vec3 viewDir = normalize(-vVertexPos);

			    // this is blinn phong
			    vec3 halfDir = normalize(lightDir + viewDir);
			    float specAngle = max(dot(halfDir, normal), 0.0);
			    specular = pow(specAngle, 16.0);
			  }
				vec4 color = vColor * texture2D(uSampler, vec2(vTex.s, vTex.t));
		    gl_FragColor = vec4(ambientColor * vec3(color) +
		                      lambertian*diffuseColor * vec3(color) +
		                      specular*specColor * vec3(color), 1.0);

				//gl_FragColor = vColor * texture2D(uSampler, vec2(vTex.s, vTex.t));
			}
		</script>

		<!--  JQUERY STUFF FOR COOL UI THINGS -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
		<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
 		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>

		<script type="text/javascript" src="webgl-utils.js"></script><style type="text/css"></style>
		<script type="text/javascript" src="initShaders.js"></script>
		<script type="text/javascript" src="MV.js"></script>
		<script type="text/javascript" src="models.js"></script>
		<script type="text/javascript" src="lighting_and_shadow.js"></script>
	</head>

	<body style="background:darkblue; padding:0px; margin:0px;">
			<canvas id="gl-canvas" width="512" height="512" style="z-index:0; padding:0px; margin:0px;">
				Oops... your browser doesn't support the HTML5 canvas element
			</canvas>
			<inline style="width:300px; height:45px; z-index:1; block:none; position:absolute; left:40%; top:10px; border:2px solid #990000; border-radius:5px; background-color:#8c8c8c; opacity:0.7;">
				<p id="positionText" style="color:white; position:absolute; left:10px; top:-10px; font:14px Helvetica;">Position: (0, 0, 0)</p>
				<p id="rotationText" style="color:white; position:absolute; left:10px; top:10px; font:14px Helvetica;">Rotation: (0, 0, 0)</p>
			</inline>
			<inline style="width:150px; height:70px; z-index:1; block:none; position:absolute; left:10px; top:10px; border:2px solid #990000; border-radius:5px; background-color:#8c8c8c; opacity:0.7;">
				<input id="rotateCheck" checked="true" type="checkbox" style="position:relative; left:5px; top:4px;"><label style="position:relative; top:5px; left:10px; color:white; font:14px Helvetica;">Rotate Models</label></input>
				<br />
				<input id="movementCheck" checked="true" type="checkbox" style="position:relative; left:5px; top:4px;"><label style="position:relative; top:5px; left:10px; color:white; font:14px Helvetica;">Move Models</label></input>
				<br />
				<input id="axisCheck" checked="true" type="checkbox" style="position:relative; left:5px; top:4px;"><label style="position:relative; top:5px; left:10px; color:white; font:14px Helvetica;">Show Axis</label></input>
			</inline>
			<!--<audio controls loop autoplay style="position:absolute; left:180px; top:10px;" id="music">
				  <source src="taswell.mp3" type="audio/mpeg">
					Your browser does not support the audio element.
			</audio>-->
	</body>
</html>
